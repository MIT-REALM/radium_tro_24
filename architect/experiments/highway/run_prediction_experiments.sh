#!/bin/bash

conda activate architect_env

wait;

EXPNAME="mala_1" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 0 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --grad_clip 1 --L 5 --repair --predict --savename highway_walls &
EXPNAME="mala_1" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 1 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --grad_clip 1 --L 5 --repair --predict --savename highway_walls &
EXPNAME="mala_1" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 2 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --grad_clip 1 --L 5 --repair --predict --savename highway_walls &
EXPNAME="mala_1" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 3 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --grad_clip 1 --L 5 --repair --predict --savename highway_walls &

EXPNAME="rmh" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 0 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --disable_gradients --L 5 --no-temper --repair --predict --savename highway_walls &
EXPNAME="rmh" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 1 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --disable_gradients --L 5 --no-temper --repair --predict --savename highway_walls &
EXPNAME="rmh" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 2 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --disable_gradients --L 5 --no-temper --repair --predict --savename highway_walls &
EXPNAME="rmh" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 3 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --disable_gradients --L 5 --no-temper --repair --predict --savename highway_walls &

EXPNAME="l2c" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 0 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --reinforce --no-temper --repair --predict --savename highway_walls &
EXPNAME="l2c" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 1 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --reinforce --no-temper --repair --predict --savename highway_walls &
EXPNAME="l2c" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 2 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --reinforce --no-temper --repair --predict --savename highway_walls &
EXPNAME="l2c" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 3 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --reinforce --no-temper --repair --predict --savename highway_walls &

EXPNAME="gd"  CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 0 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --grad_clip 1 --disable_stochasticity --no-temper --repair --predict --savename highway_walls &
EXPNAME="gd"  CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 1 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --grad_clip 1 --disable_stochasticity --no-temper --repair --predict --savename highway_walls &
EXPNAME="gd"  CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 2 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --grad_clip 1 --disable_stochasticity --no-temper --repair --predict --savename highway_walls &
EXPNAME="gd"  CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 3 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-4 --grad_clip 1 --disable_stochasticity --no-temper --repair --predict --savename highway_walls &

# EXPNAME="hmc" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 0 --num_rounds 10 --num_steps_per_round 2 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-3 --L 5 --hmc --num_hmc_integration_steps 5 --repair --predict --savename highway_walls &
# EXPNAME="mala_0" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 0 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-3 --L 5 --zero_order_gradients --repair --predict --savename highway_walls &



# EXPNAME="hmc" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 1 --num_rounds 10 --num_steps_per_round 2 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-3 --L 5 --hmc --num_hmc_integration_steps 5 --repair --predict --savename highway_walls &
# EXPNAME="mala_0" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 1 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-3 --L 5 --zero_order_gradients --repair --predict --savename highway_walls &

# wait;



# EXPNAME="hmc" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 2 --num_rounds 10 --num_steps_per_round 2 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-3 --L 5 --hmc --num_hmc_integration_steps 5 --repair --predict --savename highway_walls &
# EXPNAME="mala_0" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 2 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-3 --L 5 --zero_order_gradients --repair --predict --savename highway_walls &



# EXPNAME="hmc" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 3 --num_rounds 10 --num_steps_per_round 2 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-3 --L 5 --hmc --num_hmc_integration_steps 5 --repair --predict --savename highway_walls &
# EXPNAME="mala_0" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/highway/predict_and_mitigate.py --model_path results/highway/initial_policy.eqx --seed 3 --num_rounds 10 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-3 --L 5 --zero_order_gradients --repair --predict --savename highway_walls &
