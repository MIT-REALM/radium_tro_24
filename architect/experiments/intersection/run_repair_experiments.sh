#!/bin/bash
for seed in 0 1 2 3
do
    EXPNAME="radium" CUDA_VISIBLE_DEVICES=$seed, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/neurips_submission/intersection/initial_policy.eqx --seed $seed --num_rounds 20 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-5 --L 5 --grad_clip 1 --quench_rounds 5 --repair --predict --savename tro4-intersection &
    EXPNAME="rmh"    CUDA_VISIBLE_DEVICES=$seed, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/neurips_submission/intersection/initial_policy.eqx --seed $seed --num_rounds 20 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-5 --L 5 --grad_clip 1 --disable_gradients --no-temper --repair --predict --savename tro4-intersection &
    EXPNAME="l2c"    CUDA_VISIBLE_DEVICES=$seed, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/neurips_submission/intersection/initial_policy.eqx --seed $seed --num_rounds 20 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-5 --L 5 --grad_clip 1 --reinforce --no-temper --repair --predict --savename tro4-intersection &
    EXPNAME="gda"    CUDA_VISIBLE_DEVICES=$seed, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/neurips_submission/intersection/initial_policy.eqx --seed $seed --num_rounds 20 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-5 --L 5 --grad_clip 1 --disable_stochasticity --no-temper --repair --predict --savename tro4-intersection &
    EXPNAME="gd"     CUDA_VISIBLE_DEVICES=$seed, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/neurips_submission/intersection/initial_policy.eqx --seed $seed --num_rounds 20 --num_steps_per_round 10 --num_chains 5 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-5 --L 5 --grad_clip 1 --disable_stochasticity --no-temper --repair --no-predict --savename tro4-intersection &
done